RewriteEngine On

# Remove www.
RewriteCond %{HTTP_HOST} ^www.nccwtbp.org$ [NC]
RewriteRule ^(.*)$ http://nccwtbp.org/$1 [R=301,L]

RewriteCond %{HTTP_HOST} ^www.workforceproject.org$ [NC]
RewriteRule ^(.*)$ http://workforceproject.org/$1 [R=301,L]

RewriteCond %{HTTP_HOST} ^www.maximizingresources.org$ [NC]
RewriteRule ^(.*)$ http://maximizingresources.org/$1 [R=301,L]

# Redirect nccwtbp.org to workforceproject.org
RewriteCond %{HTTP_HOST} nccwtbp\.org [NC]
RewriteRule ^(.*)$ http://workforceproject.org/$1 [R=301,L]

# Redirect some old NCCBP urls
Redirect 301 /content/peer-institutions http://nccbp.org/peers
Redirect 301 /content/data-confidentiality-and-use http://nccbp.org/confidentiality
Redirect 301 /user/confidentiality http://nccbp.org/confidentiality
Redirect 301 /nccbp-favicon.ico http://nccbp.org/images/nccbp-favicon.ico

# Some old NCCBP urls that are just gone for good
RewriteRule ^sites/default/ - [G,L]
RewriteRule ^sites/all/ - [G,L]
RewriteRule ^institution/profile - [G,L]
RewriteRule ^_FileLibrary - [G,L]
RewriteRule ^payment/ipeds - [G,L]
RewriteRule ^files/out\.html - [G,L]

# The following rule tells Apache that if the requested filename
# exists, simply serve it.
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
# The following rewrites all other queries to index.php. The 
# condition ensures that if you are using Apache aliases to do
# mass virtual hosting, the base path will be prepended to 
# allow proper resolution of the index.php file; it will work
# in non-aliased environments as well, providing a safe, one-size 
# fits all solution.
RewriteCond %{REQUEST_URI}::$1 ^(/.+)(.+)::\2$
RewriteRule ^(.*) - [E=BASE:%1]
RewriteRule ^(.*)$ %{ENV:BASE}index.php [NC,L]

#favicon
RewriteCond %{HTTP_HOST} ^nccbp.org$ [NC]
RewriteRule ^favicon\.ico$ images/nccbp-favicon.ico [L,NC]

RewriteCond %{HTTP_HOST} ^new.nccbp.org$ [NC]
RewriteRule ^favicon\.ico$ images/nccbp-favicon.ico [L,NC]

RewriteCond %{HTTP_HOST} ^alpha.nccbp.dan.com$ [NC]
RewriteRule ^favicon\.ico$ images/nccbp-favicon.ico [L,NC]


# compress text, html, javascript, css, xml:
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript
