<?= $this->headLink()->appendStylesheet('/css/peer-comparison.css') ?>
<?php
$this->headScript()->appendFile(
    '/js/report.js?v=6',
    'text/javascript'
); ?>


<h1>Peer Comparison Report</h1>

<p>
    <span class="peer-titles">Report year:</span><br>
    <?= $report['year'] ?>
</p>

<p>
    <span class="peer-titles">Home institution:</span><br>
    <?= $report['currentCollege'] ?>
</p>

<p>
    <span class="peer-titles">Peer institutions:</span><br>
    <?= implode(', ', $report['colleges']) ?>
    <?php if (count($report['sections']) > 1): ?>
        (Peers will be omitted from charts and tables if they did not report relevant data.)
    <?php endif ?>
</p>

<?php if (!empty($peerGroupName)): ?>
<p>
    <span class="peer-titles">Peer group:</span><br>
    <?= $peerGroupName ?>
</p>
<?php endif ?>

<p>
    <a href="<?= $this->url(
        'reports/peer-results',
        array('format' => 'excel')
    ) ?>" class="btn btn-default">Download</a>
</p>

<div class="container-fluid">
    <?php foreach ($report['sections'] as $section): ?>

        <div class="row-fluid row">
            <div class="span12 col-md-12">
                <h3><?= $section['benchmark'] ?></h3>
            </div>
        </div>

        <div class="row-fluid row peerSummarySection clearfix">
            <div class="span6 col-md-6" style="padding-top: 13px">
                <?= $this->chart($section['chart']) ?>
            </div>

            <div class="span6 col-md-6">
                <table class="table table-hover table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>Institution</th>
                            <th>Benchmark</th>
                            <th>National<br>% Rank</th>
                        </tr>
                    </thead>
                    <tbody>
                        <?php foreach ($section['data'] as $collegeId => $peerData): ?>
                            <tr>
                                <td>
                                    <?= $peerData['label'] ?>
                                </td>
                                <td>
                                    <?php
                                        $value = $peerData['value'];
                                        if ($section['isNumber']) {
                                            $value = number_format($peerData['value'], $section['decimal_places']);
                                        }
                                    ?>

                                    <?= $section['suffix'] . $value . $section['prefix'] ?></td>
                                </td>

                                <td>
                                    <?= round($peerData['percentileRank']) ?>%
                                </td>
                            </tr>
                        <?php endforeach ?>
                    </tbody>
                </table>
            </div>

        </div>
    <?php endforeach ?>
</div>

<?php if (!empty($report['skipped'])): ?>
    <p>The following benchmarks are not included in the report because fewer than 5 or your selected peers reported data for them:</p>

    <ul>
        <?php foreach ($report['skipped'] as $benchmark): ?>
            <li><?= $benchmark ?></li>
        <?php endforeach ?>
    </ul>

<?php endif ?>

<?php if (!empty($report['youHaveNoData'])): ?>
    <p>The following benchmarks are not included in the report because your institution did not submit data for them:</p>

    <ul>
        <?php foreach ($report['youHaveNoData'] as $benchmark): ?>
            <li><?= $benchmark ?></li>
        <?php endforeach ?>
    </ul>

<?php endif ?>
