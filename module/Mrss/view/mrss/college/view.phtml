<? /** @var \Mrss\Entity\College $college */ ?>

<div class="btn-group heading-btns">
    <a class="btn btn-default" href="<?= $this->url('colleges/edit', array('id' => $college->getId())) ?>">
        <i class="glyphicon glyphicon-pencil"></i>
        Edit Institution</a>
    </a>
</div>

<h1><?= $college->getName() ?></h1>


<table class="style1">
    <tr>
        <td>
            IPEDS Unit ID:
        </td>
        <td>
            <?= $college->getIpeds() ?>
        </td>
    </tr>
    <tr>
        <td>
            OPE ID:
        </td>
        <td>
            <?= $college->getOpeId() ?>
        </td>
    </tr>
    <tr>
        <td>
            Address:
        </td>
        <td>
            <?= $college->getFullAddress() ?>
        </td>
    </tr>
    <tr>
        <td>
            Executive:
        </td>
        <td>
            <?= $college->getExecTitle() ?><br>
            <?= $college->getExecFullName() ?><br>
            <?= $college->getExecEmail() ?>
        </td>
    </tr>
    <tr>
        <td>
            Subscriptions:
        </td>
        <td>
            <table class="table">
                <thead>
                    <tr>
                        <th>Year</th>
                        <th>Study</th>
                        <th>Completion</th>
                        <th>Suppressions</th>
                    </tr>
                </thead>
                <tbody>
                    <?php foreach ($college->getSubscriptions() as $subscription): ?>
                    <tr>
                        <td>
                            <?= $subscription->getYear() ?>
                        </td>
                        <td>
                            <?= $subscription->getStudy()->getName() ?>
                        </td>
                        <td>
                            <a href="<?= $this->url(
                                'observation',
                                array('id' => $subscription->getObservation()->getId())
                            ) ?>">
                            <?= $subscription->getStudy()->getCompletionPercentage(
                                $subscription->getObservation()
                            ) ?>%
                            </a>
                        </td>
                        <td>
                            <?php if ($suppressions = $subscription->getSuppressionList()): ?>

                                <?= $suppressions ?>

                            <?php endif ?>
                            &nbsp;&nbsp;
                            <a href="<?= $this->url('suppressions/edit', array('subscription' => $subscription->getId())) ?>">
                                Manage Suppressions
                            </a>
                        </td>
                    </tr>
                    <?php endforeach ?>
                </tbody>

            </table>

            <a href="/admin/changes/<?= $college->getId() ?>">Recent Data Changes</a>
        </td>
    </tr>
    <tr>
        <td>
            Users:
        </td>
        <td>
            <ul>
                <?php foreach ($college->getUsers() as $user): ?>
                    <li>
                        <a title="Impersonate this user"
                           href="/admin/user/impersonate/<?= $user->getId() ?>">
                            <i class="icon icon-fire glyphicon glyphicon-transfer"></i></a>
                        <a href="<?= $this->url(
                            'users/edit',
                            array('id' => $user->getId())
                        ) ?>"><?= $user->getFullName() ?></a>
                        (<?= $user->getRole() ?>)
                    </li>
                <?php endforeach ?>
            </ul>

            <a href="<?= $this->url('users/edit', array('id' => 'add', 'college' => $college->getId())) ?>" class="btn btn-default">
                <span class="glyphicon glyphicon-plus icon icon-plus"></span>
                Add User
            </a>
        </td>
    </tr>
</table>
